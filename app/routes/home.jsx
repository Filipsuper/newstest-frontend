import { useEffect, useState } from "react";
import { pnlColor } from "../utils/utils";
import { fetchArticle } from "../utils/api";
import dayjs from "dayjs";
import ArticleComponent from "../components/ArticleComponent";
import PreviousArticle from "../components/PreviousArticle";

export function meta() {
  return [
    { title: "Morningsum - Daily Stock Market Summary" },
    { name: "description", content: "Daily summary of the Swedish stock market generated by AI" },
  ];
}

export const loader = async () => {
  const article = await fetchArticle();
  return article;
};

export default function Home({ loaderData }) {
  const articles = loaderData

  if (!articles) {
    return <div className="text-text">Loading...</div>;
  }

  return (
    <main className="min-h-screen bg-background  relative ">
      <div className="absolute inset-0 z-20 bg-[url(https://grainy-gradients.vercel.app/noise.svg)] opacity-20 pointer-events-none"></div>

      <header className=" w-full px-10 py-2 relative z-10 bg-foreground border-b border-border mb-8">
        <span className="text-xl text-border font-serif font-black italic pb-2">Morningsum</span>
        {/* <p className="text-lg text-text-muted mb-4 prose">Morningsum is a daily summary of the stock market focusing on the Swedish Market. The summary is generated by an LLM based on the latest market news and data. The summary is updated daily at 08:30 CEST</p> */}
      </header>

      <ArticleComponent article={articles[0]} />
      <div className="w-full py-4 border-t border-border mx-auto px-4 mt-14 relative z-10">
        <div className="max-w-6xl mx-auto px-4 mt-8 relative z-10">
          <h2 className=" text-2xl font-serif font-black text-text-muted italic mb-4 mt-8">Previous Summaries</h2>
        </div>
        <div className="max-w-6xl mx-auto px-4 mt-8 grid grid-cols-1 grid-rows-4  md:grid-cols-2 md:grid-rows-2 relative z-10">
          {articles.slice(1).map((article, idx) => (
            <PreviousArticle key={idx} article={article} />
          ))}
        </div>
      </div>


      <footer className="max-w-4xl mx-auto px-4 py-4 mt-8 relative z-10">
        <p className="text-text-muted text-sm">Â© 2025 Morningsum</p>
      </footer>
    </main>
  );
}